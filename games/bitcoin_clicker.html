<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bitcoin Clicker Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #23272a; 
            color: #f5c242; 
            text-align: center; 
            margin: 0; 
            padding: 0; 
        }
        h1 {
            margin-top: 30px;
        }
        #bitcoin-btn {
            margin: 24px 0;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            font-size: 2em;
            background: #f5c242;
            color: #23272a;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px #0008;
            transition: transform 0.1s;
        }
        #bitcoin-btn:active {
            transform: scale(0.95);
        }
        #bitcoins {
            font-size: 2em;
            margin: 10px 0 24px 0;
        }
        #shop {
            background: #31343a;
            margin: 30px auto;
            padding: 20px;
            max-width: 350px;
            border-radius: 12px;
            box-shadow: 0 2px 8px #0006;
        }
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #23272a;
            padding: 10px 18px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .shop-item button {
            background: #f5c242;
            color: #23272a;
            border: none;
            padding: 5px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }
        .shop-item button:disabled {
            background: #a28f59;
            cursor: not-allowed;
        }
        #reset-btn {
            margin: 20px;
            background: #e74c3c;
            color: #fff;
            border: none;
            padding: 8px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        #reset-btn:hover {
            background: #c0392b;
        }
    </style>
</head>
<body>
    <h1>Bitcoin Clicker</h1>
    <div id="bitcoins">₿ 0</div>
    <button id="bitcoin-btn">Mine</button>

    <div id="shop">
        <h2>Shop</h2>
        <div id="shop-items"></div>
    </div>

    <button id="reset-btn">Reset Game</button>

    <script>
        // Game State
        let state = {
            bitcoins: 0,
            perClick: 1,
            perSecond: 0,
            upgrades: {
                pickaxe: 0,
                miner: 0,
                rig: 0,
                js: 0
            }
        };

        // Upgrades definition
        const upgrades = [
            {
                key: 'pickaxe',
                name: 'Pickaxe',
                desc: '+1 per click',
                baseCost: 10,
                cost: () => 10 + state.upgrades.pickaxe * 15,
                buy: () => { state.perClick += 1; }
            },
            {
                key: 'miner',
                name: 'Miner',
                desc: '+1 per second',
                baseCost: 50,
                cost: () => 50 + state.upgrades.miner * 35,
                buy: () => { state.perSecond += 1; }
            },
            {
                key: 'rig',
                name: 'Mining Rig',
                desc: '+10 per second',
                baseCost: 300,
                cost: () => 300 + state.upgrades.rig * 150,
                buy: () => { state.perSecond += 10; }
            },
            {
                key: 'js',
                name: 'JavaScript Console',
                desc: '+50 per second',
                baseCost: 1400,
                cost: () => 1400 + state.upgrades.js * 280,
                buy: () => { state.perSecond += 50; }
            } 
        ];

        // Utilities
        function saveState() {
            localStorage.setItem('btcClickerState', JSON.stringify(state));
        }

        function loadState() {
            const saved = localStorage.getItem('btcClickerState');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    // Restore all fields, fallback to defaults if missing
                    state = Object.assign(state, parsed);
                } catch {}
            }
        }
        function loadState() {
            const saved = localStorage.getItem('btcClickerState');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    state = Object.assign(state, parsed);
                   // Ensure all upgrade keys exist and are numbers
                   for (const upg of upgrades) {
                   if (typeof state.upgrades[upg.key] !== 'number') {
                      state.upgrades[upg.key] = 0;
                      }
                }
            }
        } catch {}
    }
}

        function updateDisplay() {
            document.getElementById('bitcoins').textContent = `₿ ${state.bitcoins.toLocaleString()}`;
            // Shop Items
            const container = document.getElementById('shop-items');
            container.innerHTML = '';
            upgrades.forEach(upg => {
                const amount = state.upgrades[upg.key] ?? 0;
                const cost = upg.cost();
                const canBuy = state.bitcoins >= cost;
                const div = document.createElement('div');
                div.className = 'shop-item';
                div.innerHTML = `
                    <div>
                        <strong>${upg.name}</strong><br>
                        <small>${upg.desc}</small><br>
                        <small>Owned: ${amount}</small>
                    </div>
                    <div>
                        <button ${canBuy ? '' : 'disabled'} data-upg="${upg.key}">Buy<br>₿${cost}</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function buyUpgrade(key) {
            const upg = upgrades.find(u => u.key === key);
            if (!upg) return;
            const cost = upg.cost();
            if (state.bitcoins >= cost) {
                state.bitcoins -= cost;
                state.upgrades[key]++;
                upg.buy();
                saveState();
                updateDisplay();
            }
        }

        // Event Listeners
        document.getElementById('bitcoin-btn').onclick = () => {
            state.bitcoins += state.perClick;
            saveState();
            updateDisplay();
        };

        document.getElementById('shop-items').onclick = (e) => {
            if (e.target.tagName === 'BUTTON' && e.target.hasAttribute('data-upg')) {
                buyUpgrade(e.target.getAttribute('data-upg'));
            }
        };

        document.getElementById('reset-btn').onclick = () => {
            if (confirm('Are you sure you want to reset your game?')) {
                localStorage.removeItem('btcClickerState');
                state = {
                    bitcoins: 0,
                    perClick: 1,
                    perSecond: 0,
                    upgrades: {
                        pickaxe: 0,
                        miner: 0,
                        rig: 0
                    }
                };
                for (const upg of upgrades) {
                    state.upgrades[upg.key] = 0;
                }
                saveState();
                updateDisplay();
            }
        };

        // Passive gain
        setInterval(() => {
            if (state.perSecond > 0) {
                state.bitcoins += state.perSecond;
                saveState();
                updateDisplay();
            }
        }, 1000);

        // Initialize
        loadState();
        updateDisplay();
    </script>
</body>
</html>
